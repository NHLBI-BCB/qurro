<!doctype html>
<!-- Based on the Basic Example in https://github.com/vega/vega-embed -->
<html>
    <head>
        <meta charset="utf-8" />
        <title>
            RankRatioViz
        </title>
        <link rel="shortcut icon" href="icon.png" />
        <!-- jQuery, Vega, Vega-Lite, Vega-Embed, MathJax -->
        <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega@3/build/vega.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-lite@2.6.0/build/vega-lite.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/vega-embed@3.23.1/build/vega-embed.min.js"></script>
        <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML' async></script>
        <script src="linked_plots.js"></script>
        <script>
            // Run on page load
            ssmv.loadJSONFiles();
        </script>

        <style>
            h3,p {
                text-align: center;
            }
            body,input,button,select {
                font-size: large;
            }
            .plottd {
                width: 50%;
            }
        </style>
    </head>

    <body>
        <table style="width:100%;">
            <!-- Show the actual plots -->
            <tr>
                <td class="plottd" style="text-align: right;">
                    <div id="rankPlot"></div>
                </td>
                <td class="plottd" style="text-align: left;">
                    <div id="samplePlot"></div>
                </td>
            </tr>
            <!-- This row of the table shows the log ratio created from
                selecting single microbes in the rank plot.
            -->
            <tr>
                <td colspan="2" style="text-align:left;">
                    <p id="logRatioDisplay">\[\]</p>
                </td>
            </tr>
            <tr>
                <td style="vertical-align:top;">
                    <h3>Single-Microbe Selections</h3>
                    <p>
                        Select two microbes from the rank plot (left) to
                        display their log ratios for each sample in the sample
                        scatterplot (right).
                    </p>
                </td>
                <td>
                    <h3>Multi-Microbe Selections</h3>
                    <p>
                        Use the controls here to show more complex log ratios
                        in the sample scatterplot.
                    </p>
                    <p>
                        Filter numerator to taxa that
                        <select id="topSearch">
                            <option value="rank">
                                contain the exact rank(s)
                            </option>
                            <option value="text">
                                contain the exact text
                            </option>
                        </select>
                        <input type="text" id="topText" size="40"></input>
                    </p>
                    <p>
                        Filter denominator to taxa that
                        <select id="botSearch">
                            <option value="rank">
                                contain the exact rank(s)
                            </option>
                            <option value="text">
                                contain the exact text
                            </option>
                        </select>
                        <input type="text" id="botText" size="40"></input>
                    </p>

                    <p>
                        <button onclick="ssmv.updateSamplePlotMulti();">
                            Regenerate sample plot
                        </button>
                    </p>
                    <p>
                        <label for="selectMicrobesFileSelector">
                            <strong>
                                Upload "Select Microbes" List:
                            </strong>
                        </label>
                        <input type="file" id="selectMicrobesFileSelector"
                            onChange="ssmv.uploadSelectMicrobesFile();" />
                    </p>
                    <p>
                        <label for="zeroFillInput">
                            <strong>
                                Value to fill in for zero-abundance microbes:
                            </strong>
                        </label>
                        <input type="number" id="zeroFillInput" min="0"
                            max="1000" value="0">
                        </input>
                    </p>
                </td>
        </table>
    </body>
</html>
